---
title: "Ruaha_Katavi"
author: "Caroline Williams"
output:
  prettydoc::html_pretty:
    theme: leonids
    highlight: github
vignette: >
  %\VignetteIndexEntry{Ruaha_Katavi}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Import Libraries
```{r}
library(raster)
library(sf)
```

## Read Boundary SA Shapefile
```{r}
RKL <- st_read("C:/Users/Caroline/Documents/Graduate Courses/Spring 2021 Courses/GEOG 382/Project/WCS/inst/extdata/boundary/RKL.shp")
RKL_proj <- st_read("C:/Users/Caroline/Documents/Graduate Courses/Spring 2021 Courses/GEOG 382/Project/WCS/inst/extdata/boundary/RKL_proj.vct")
```

# Precipitation
## Read WorldClim data
```{r}
# import precipitation 2000-2009 & 2010 to 2018  
# set working directory to where data is located
setwd("D:/WCS/data/precip/monthly_clipped")

# list files based on prefix
precip_list = list.files(getwd(), pattern="wc2.1_2.5m_prec_") 

# Create raster stack
precip_r <- stack(precip_list)
names(precip_r)   
```

## Clip Climate data to Ruaha-Katavki boundary
```{r}
# clip precipitation 2000 - 2018 to study area
precip_crop <- crop(precip_r, RKL) # crop to extent
precip_clip <- mask(precip_crop, RKL) # mask cropped data to study area
```

# Export R Stack- no analysis just clipped to SA RKL
```{r}
writeRaster(precip_clip, filename=names(precip_clip), "D:/WCS/data/precip/monthly_clipped/precip_monthly_2000_2018.tif")
writeRaster(precip_clip, names(precip_clip), bylayer=TRUE,format="GTiff", "D:/WCS/data/precip/monthly_clipped/", overwrite = TRUE)

precip_clip_unstack <- unstack(precip_clip)
names(precip_clip_unstack) <- names(precip_clip)
#outputnames <- paste(seq_along(precip_clip_unstack), ".tiff",sep="")
for(i in seq_along(precip_clip_unstack)){writeRaster(precip_clip_unstack[[i]], file=precip_list[i], overwrite = TRUE)}
```

## Climate Spatial Analysis
### Precipitation Annual Mean Monthly
```{r}
# 2000 Annual Mean
# create raster stack subset for 2000
p_2000 <- raster::subset(precip_clip, 1:12)

# calculate mean precipitation for 2000
precip_2000 <- calc(p_2000, fun = mean, na.rm = T)

# 2001 Annual Mean
# create raster stack subset for 2001
p_2001 <- raster::subset(precip_clip, 13:24)

# calculate mean precipitation for 2001
precip_2001 <- calc(p_2001, fun = mean, na.rm = T)

# 2002 Annual Mean
# create raster stack subset for 2002
p_2002 <- raster::subset(precip_clip, 25:36)

# calculate mean precipitation for 2002
precip_2002 <- calc(p_2002, fun = mean, na.rm = T)

# 2003 Annual Mean
# create raster stack subset for 2003
p_2003 <- raster::subset(precip_clip, 37:48)

# calculate mean precipitation for 2003
precip_2003 <- calc(p_2003, fun = mean, na.rm = T)

# 2004 Annual Mean
# create raster stack subset for 2004
p_2004 <- raster::subset(precip_clip, 49:60)

# calculate mean precipitation for 2004
precip_2004 <- calc(p_2004, fun = mean, na.rm = T)

# 2005 Annual Mean
# create raster stack subset for 2005
p_2005 <- raster::subset(precip_clip, 61:72)

# calculate mean precipitation for 2005
precip_2005 <- calc(p_2005, fun = mean, na.rm = T)

# 2006 Annual Mean
# create raster stack subset for 2006
p_2006 <- raster::subset(precip_clip, 73:84)

# calculate mean precipitation for 2006
precip_2006 <- calc(p_2006, fun = mean, na.rm = T)

# 2007 Annual Mean
# create raster stack subset for 2007
p_2007 <- raster::subset(precip_clip, 85:96)

# calculate mean precipitation for 2007
precip_2007 <- calc(p_2007, fun = mean, na.rm = T)

# 2008Annual Mean
# create raster stack subset for 2008
p_2008 <- raster::subset(precip_clip, 97:108)

# calculate mean precipitation for 2008
precip_2008 <- calc(p_2008, fun = mean, na.rm = T)

# 2009 Annual Mean
# create raster stack subset for 2009
p_2009 <- raster::subset(precip_clip, 109:120)

# calculate mean precipitation for 2009
precip_2009 <- calc(p_2009, fun = mean, na.rm = T)

# 2010 Annual Mean
# create raster stack subset for 2010
p_2010 <- raster::subset(precip_clip, 121:132)

# calculate mean precipitation for 2010
precip_2010 <- calc(p_2010, fun = mean, na.rm = T)

# 2011 Annual Mean
# create raster stack subset for 2011
p_2011 <- raster::subset(precip_clip, 133:144)

# calculate mean precipitation for 2011
precip_2011 <- calc(p_2011, fun = mean, na.rm = T)

# 2012 Annual Mean
# create raster stack subset for 2012
p_2012 <- raster::subset(precip_clip, 145:156)

# calculate mean precipitation for 2012
precip_2012 <- calc(p_2012, fun = mean, na.rm = T)

# 2013 Annual Mean
# create raster stack subset for 2013
p_2013 <- raster::subset(precip_clip, 157:168)

# calculate mean precipitation for 2013
precip_2013 <- calc(p_2013, fun = mean, na.rm = T)

# 2014 Annual Mean
# create raster stack subset for 2014
p_2014 <- raster::subset(precip_clip, 169:180)

# calculate mean precipitation for 2014
precip_2014 <- calc(p_2014, fun = mean, na.rm = T)

# 2015 Annual Mean
# create raster stack subset for 2015
p_2015 <- raster::subset(precip_clip, 181:192)

# calculate mean precipitation for 2015
precip_2015 <- calc(p_2015, fun = mean, na.rm = T)

# 2016 Annual Mean
# create raster stack subset for 2016
p_2016 <- raster::subset(precip_clip, 193:204)

# calculate mean precipitation for 2016
precip_2016 <- calc(p_2016, fun = mean, na.rm = T)

# 2017 Annual Mean
# create raster stack subset for 2017
p_2017 <- raster::subset(precip_clip, 205:216)

# calculate mean precipitation for 2017
precip_2017 <- calc(p_2017, fun = mean, na.rm = T)

# 2018 Annual Mean
# create raster stack subset for 2018
p_2018 <- raster::subset(precip_clip, 217:228)

# calculate mean precipitation for 2018
precip_2018 <- calc(p_2018, fun = mean, na.rm = T)
```

### Mean Precipitation 2000 - 2018
```{r}
# create raster stack of mean annual precipitation
p_2000_2018 <- stack(precip_2000, precip_2001, precip_2002, precip_2003, precip_2004, precip_2005, precip_2006, precip_2007, precip_2008, precip_2009, precip_2010, precip_2011, precip_2012, precip_2013, precip_2014, precip_2015, precip_2016, precip_2017, precip_2018)

# calculate mean precipitation 2000 to 2018
precip_2000_2018 <- calc(p_2000_2018, fun = mean, na.rm = T)
```

## Export Processed data
```{r}
writeRaster(precip_2000, "D:/WCS/data/precip/r_outputs/precip_annual_2000.rst", overwrite = TRUE)
writeRaster(precip_2001, "D:/WCS/data/precip/r_outputs/precip_annual_2001.rst", overwrite = TRUE)
writeRaster(precip_2002, "D:/WCS/data/precip/r_outputs/precip_annual_2002.rst", overwrite = TRUE)
writeRaster(precip_2003, "D:/WCS/data/precip/r_outputs/precip_annual_2003.rst", overwrite = TRUE)
writeRaster(precip_2004, "D:/WCS/data/precip/r_outputs/precip_annual_2004.rst", overwrite = TRUE)
writeRaster(precip_2005, "D:/WCS/data/precip/r_outputs/precip_annual_2005.rst", overwrite = TRUE)
writeRaster(precip_2006, "D:/WCS/data/precip/r_outputs/precip_annual_2006.rst", overwrite = TRUE)
writeRaster(precip_2007, "D:/WCS/data/precip/r_outputs/precip_annual_2007.rst", overwrite = TRUE)
writeRaster(precip_2008, "D:/WCS/data/precip/r_outputs/precip_annual_2008.rst", overwrite = TRUE)
writeRaster(precip_2009, "D:/WCS/data/precip/r_outputs/precip_annual_2009.rst", overwrite = TRUE)
writeRaster(precip_2010, "D:/WCS/data/precip/r_outputs/precip_annual_2010.rst", overwrite = TRUE)
writeRaster(precip_2011, "D:/WCS/data/precip/r_outputs/precip_annual_2011.rst", overwrite = TRUE)
writeRaster(precip_2012, "D:/WCS/data/precip/r_outputs/precip_annual_2012.rst", overwrite = TRUE)
writeRaster(precip_2013, "D:/WCS/data/precip/r_outputs/precip_annual_2013.rst", overwrite = TRUE)
writeRaster(precip_2014, "D:/WCS/data/precip/r_outputs/precip_annual_2014.rst", overwrite = TRUE)
writeRaster(precip_2015, "D:/WCS/data/precip/r_outputs/precip_annual_2015.rst", overwrite = TRUE)
writeRaster(precip_2016, "D:/WCS/data/precip/r_outputs/precip_annual_2016.rst", overwrite = TRUE)
writeRaster(precip_2017, "D:/WCS/data/precip/r_outputs/precip_annual_2017.rst", overwrite = TRUE)
writeRaster(precip_2018, "D:/WCS/data/precip/r_outputs/precip_annual_2018.rst", overwrite = TRUE)
writeRaster(precip_2000_2018, "D:/WCS/data/precip/r_outputs/precip_annual_2000_2018.rst", overwrite = TRUE)
```

### Visualizations Precipitation
#### Import Libraries
```{r}
library(lattice)
library(rasterVis)
library(GISTools) 
library(viridisLite)
library(sp)
library(ggsn)
library(prettymapr)
library(ggspatial)
```

#### Map - Annual Mean Precipitation 2000 - 2018
```{r}
col = viridis(100)
par(mfrow=c(2,2))
p1 <- levelplot(precip_2000_2018,
                margin = FALSE,
                xlab = "",
                ylab = "",
                scales=list(draw = FALSE),
                main = "Annual Mean Precipitation", 
                col.regions = rev(col),
                par.settings= list(panel.background = list(col = "grey")),
                colorkey = list(axis.line = list(col = "white"), 
                           axis.text = list(col = "black"))) 
```
--------------------------------------------------------------------------------
# Vegetation - 2000
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2000")

# list files based on prefix
evi2000_list = list.files(getwd(), pattern="2000_") 

# Create raster stack
evi2000_r <- stack(evi2000_list)
names(evi2000_r) 
```

## Calculate max evi by month per year
### 2000
```{r}
#subset by month for 2000
evi2000_2 <- raster::subset(evi2000_r, 1:1)
evi2000_3 <- raster::subset(evi2000_r, 2:3)
evi2000_4 <- raster::subset(evi2000_r, 4:5)
evi2000_5 <- raster::subset(evi2000_r, 6:7)
evi2000_6 <- raster::subset(evi2000_r, 8:9)
evi2000_7 <- raster::subset(evi2000_r, 10:11)
evi2000_8 <- raster::subset(evi2000_r, 12:13)
evi2000_9 <- raster::subset(evi2000_r, 14:15)
evi2000_10 <- raster::subset(evi2000_r, 16:17)
evi2000_11 <- raster::subset(evi2000_r, 17:18)
evi2000_12 <- raster::subset(evi2000_r, 19:20)

# calculate max evi by month for 2000
evi2000_3_max <- calc(evi2000_3, fun = max, na.rm = T)
evi2000_4_max <- calc(evi2000_4, fun = max, na.rm = T)
evi2000_5_max <- calc(evi2000_5, fun = max, na.rm = T)
evi2000_6_max <- calc(evi2000_6, fun = max, na.rm = T)
evi2000_7_max <- calc(evi2000_7, fun = max, na.rm = T)
evi2000_8_max <- calc(evi2000_8, fun = max, na.rm = T)
evi2000_9_max <- calc(evi2000_9, fun = max, na.rm = T)
evi2000_10_max <- calc(evi2000_10, fun = max, na.rm = T)
evi2000_11_max <- calc(evi2000_11, fun = max, na.rm = T)
evi2000_12_max <- calc(evi2000_12, fun = max, na.rm = T)

# raster stack
evi2000_max_stack <- stack(evi2000_2, evi2000_3_max, evi2000_4_max,
                           evi2000_5_max, evi2000_6_max, evi2000_7_max,
                           evi2000_8_max, evi2000_9_max, evi2000_10_max,
                           evi2000_11_max, evi2000_12_max)
```

## Export EVI Max data 2000
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2000/02/01"), by = "month", length.out = 11)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2000_max_stack) <- filename

# write raster stack
evi2000_max_unstack <- unstack(evi2000_max_stack)
names(evi2000_max_unstack) <- names(evi2000_max_stack)
for(i in seq_along(evi2000_max_unstack)){writeRaster(evi2000_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```
--------------------------------------------------------------------------------
# Vegetation - 2001
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2001")

# list files based on prefix
evi2001_list = list.files(getwd(), pattern="2001_") 

# Create raster stack
evi2001_r <- stack(evi2001_list)
names(evi2001_r) 
```


## Calculate max evi by month per year
### 2001
```{r}
#subset by month for 2001
evi2001_1 <- raster::subset(evi2001_r, 1:2)
evi2001_2 <- raster::subset(evi2001_r, 3:4)
evi2001_3 <- raster::subset(evi2001_r, 5:6)
evi2001_4 <- raster::subset(evi2001_r, 7:8)
evi2001_5 <- raster::subset(evi2001_r, 9:10)
evi2001_6 <- raster::subset(evi2001_r, 11:12)
evi2001_7 <- raster::subset(evi2001_r, 13:14)
evi2001_8 <- raster::subset(evi2001_r, 15:16)
evi2001_9 <- raster::subset(evi2001_r, 17:18)
evi2001_10 <- raster::subset(evi2001_r, 19:19)
evi2001_11 <- raster::subset(evi2001_r, 20:21)
evi2001_12 <- raster::subset(evi2001_r, 22:23)

# calculate max evi by month for 2001
evi2001_1_max <- calc(evi2001_1, fun = max, na.rm = T)
evi2001_2_max <- calc(evi2001_2, fun = max, na.rm = T)
evi2001_3_max <- calc(evi2001_3, fun = max, na.rm = T)
evi2001_4_max <- calc(evi2001_4, fun = max, na.rm = T)
evi2001_5_max <- calc(evi2001_5, fun = max, na.rm = T)
evi2001_6_max <- calc(evi2001_6, fun = max, na.rm = T)
evi2001_7_max <- calc(evi2001_7, fun = max, na.rm = T)
evi2001_8_max <- calc(evi2001_8, fun = max, na.rm = T)
evi2001_9_max <- calc(evi2001_9, fun = max, na.rm = T)
evi2001_11_max <- calc(evi2001_11, fun = max, na.rm = T)
evi2001_12_max <- calc(evi2001_12, fun = max, na.rm = T)

# raster stack
evi2001_max_stack <- stack(evi2001_1_max, evi2001_2_max, evi2001_3_max, 
                           evi2001_4_max, evi2001_5_max, evi2001_6_max, 
                           evi2001_7_max, evi2001_8_max, evi2001_9_max, 
                           evi2001_10, evi2001_11_max, evi2001_12_max)
```

## Export EVI Max data 2001
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2001/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2001_max_stack) <- filename

# write raster stack
evi2001_max_unstack <- unstack(evi2001_max_stack)
names(evi2001_max_unstack) <- names(evi2001_max_stack)
for(i in seq_along(evi2001_max_unstack)){writeRaster(evi2001_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```
--------------------------------------------------------------------------------
# Vegetation - 2002
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2002")

# list files based on prefix
evi2002_list = list.files(getwd(), pattern="2002_") 

# Create raster stack
evi2002_r <- stack(evi2002_list)
names(evi2002_r) 
```


## Calculate max evi by month per year
### 2002
```{r}
#subset by month for 2002
evi2002_1 <- raster::subset(evi2002_r, 1:2)
evi2002_2 <- raster::subset(evi2002_r, 3:4)
evi2002_3 <- raster::subset(evi2002_r, 5:6)
evi2002_4 <- raster::subset(evi2002_r, 7:8)
evi2002_5 <- raster::subset(evi2002_r, 9:10)
evi2002_6 <- raster::subset(evi2002_r, 11:12)
evi2002_7 <- raster::subset(evi2002_r, 13:14)
evi2002_8 <- raster::subset(evi2002_r, 15:16)
evi2002_9 <- raster::subset(evi2002_r, 17:18)
evi2002_10 <- raster::subset(evi2002_r, 19:19)
evi2002_11 <- raster::subset(evi2002_r, 20:21)
evi2002_12 <- raster::subset(evi2002_r, 22:23)

# calculate max evi by month for 2002
evi2002_1_max <- calc(evi2002_1, fun = max, na.rm = T)
evi2002_2_max <- calc(evi2002_2, fun = max, na.rm = T)
evi2002_3_max <- calc(evi2002_3, fun = max, na.rm = T)
evi2002_4_max <- calc(evi2002_4, fun = max, na.rm = T)
evi2002_5_max <- calc(evi2002_5, fun = max, na.rm = T)
evi2002_6_max <- calc(evi2002_6, fun = max, na.rm = T)
evi2002_7_max <- calc(evi2002_7, fun = max, na.rm = T)
evi2002_8_max <- calc(evi2002_8, fun = max, na.rm = T)
evi2002_9_max <- calc(evi2002_9, fun = max, na.rm = T)
evi2002_11_max <- calc(evi2002_11, fun = max, na.rm = T)
evi2002_12_max <- calc(evi2002_12, fun = max, na.rm = T)

# raster stack
evi2002_max_stack <- stack(evi2002_1_max, evi2002_2_max, evi2002_3_max, 
                           evi2002_4_max, evi2002_5_max, evi2002_6_max, 
                           evi2002_7_max, evi2002_8_max, evi2002_9_max, 
                           evi2002_10, evi2002_11_max, evi2002_12_max)
```

## Export EVI Max data 2002
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2002/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2002_max_stack) <- filename

# write raster stack
evi2002_max_unstack <- unstack(evi2002_max_stack)
names(evi2002_max_unstack) <- names(evi2002_max_stack)
for(i in seq_along(evi2002_max_unstack)){writeRaster(evi2002_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2003
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2003")

# list files based on prefix
evi2003_list = list.files(getwd(), pattern="2003_") 

# Create raster stack
evi2003_r <- stack(evi2003_list)
names(evi2003_r) 
```


## Calculate max evi by month per year
### 2003
```{r}
#subset by month for 2003
evi2003_1 <- raster::subset(evi2003_r, 1:2)
evi2003_2 <- raster::subset(evi2003_r, 3:4)
evi2003_3 <- raster::subset(evi2003_r, 5:6)
evi2003_4 <- raster::subset(evi2003_r, 7:8)
evi2003_5 <- raster::subset(evi2003_r, 9:10)
evi2003_6 <- raster::subset(evi2003_r, 11:12)
evi2003_7 <- raster::subset(evi2003_r, 13:14)
evi2003_8 <- raster::subset(evi2003_r, 15:16)
evi2003_9 <- raster::subset(evi2003_r, 17:18)
evi2003_10 <- raster::subset(evi2003_r, 19:19)
evi2003_11 <- raster::subset(evi2003_r, 20:21)
evi2003_12 <- raster::subset(evi2003_r, 22:23)

# calculate max evi by month for 2003
evi2003_1_max <- calc(evi2003_1, fun = max, na.rm = T)
evi2003_2_max <- calc(evi2003_2, fun = max, na.rm = T)
evi2003_3_max <- calc(evi2003_3, fun = max, na.rm = T)
evi2003_4_max <- calc(evi2003_4, fun = max, na.rm = T)
evi2003_5_max <- calc(evi2003_5, fun = max, na.rm = T)
evi2003_6_max <- calc(evi2003_6, fun = max, na.rm = T)
evi2003_7_max <- calc(evi2003_7, fun = max, na.rm = T)
evi2003_8_max <- calc(evi2003_8, fun = max, na.rm = T)
evi2003_9_max <- calc(evi2003_9, fun = max, na.rm = T)
evi2003_11_max <- calc(evi2003_11, fun = max, na.rm = T)
evi2003_12_max <- calc(evi2003_12, fun = max, na.rm = T)

# raster stack
evi2003_max_stack <- stack(evi2003_1_max, evi2003_2_max, evi2003_3_max, 
                           evi2003_4_max, evi2003_5_max, evi2003_6_max, 
                           evi2003_7_max, evi2003_8_max, evi2003_9_max, 
                           evi2003_10, evi2003_11_max, evi2003_12_max)
```

## Export EVI Max data 2003
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2003/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2003_max_stack) <- filename

# write raster stack
evi2003_max_unstack <- unstack(evi2003_max_stack)
names(evi2003_max_unstack) <- names(evi2003_max_stack)
for(i in seq_along(evi2003_max_unstack)){writeRaster(evi2003_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2004
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2004")

# list files based on prefix
evi2004_list = list.files(getwd(), pattern="2004_") 

# Create raster stack
evi2004_r <- stack(evi2004_list)
names(evi2004_r) 
```


## Calculate max evi by month per year
### 2004
```{r}
#subset by month for 2004
evi2004_1 <- raster::subset(evi2004_r, 1:2)
evi2004_2 <- raster::subset(evi2004_r, 3:4)
evi2004_3 <- raster::subset(evi2004_r, 5:6)
evi2004_4 <- raster::subset(evi2004_r, 7:8)
evi2004_5 <- raster::subset(evi2004_r, 9:10)
evi2004_6 <- raster::subset(evi2004_r, 11:12)
evi2004_7 <- raster::subset(evi2004_r, 13:14)
evi2004_8 <- raster::subset(evi2004_r, 15:16)
evi2004_9 <- raster::subset(evi2004_r, 17:18)
evi2004_10 <- raster::subset(evi2004_r, 19:20)
evi2004_11 <- raster::subset(evi2004_r, 21:21)
evi2004_12 <- raster::subset(evi2004_r, 22:23)

# calculate max evi by month for 2004
evi2004_1_max <- calc(evi2004_1, fun = max, na.rm = T)
evi2004_2_max <- calc(evi2004_2, fun = max, na.rm = T)
evi2004_3_max <- calc(evi2004_3, fun = max, na.rm = T)
evi2004_4_max <- calc(evi2004_4, fun = max, na.rm = T)
evi2004_5_max <- calc(evi2004_5, fun = max, na.rm = T)
evi2004_6_max <- calc(evi2004_6, fun = max, na.rm = T)
evi2004_7_max <- calc(evi2004_7, fun = max, na.rm = T)
evi2004_8_max <- calc(evi2004_8, fun = max, na.rm = T)
evi2004_9_max <- calc(evi2004_9, fun = max, na.rm = T)
evi2004_10_max <- calc(evi2004_10, fun = max, na.rm = T)
evi2004_12_max <- calc(evi2004_12, fun = max, na.rm = T)

# raster stack
evi2004_max_stack <- stack(evi2004_1_max, evi2004_2_max, evi2004_3_max, 
                           evi2004_4_max, evi2004_5_max, evi2004_6_max, 
                           evi2004_7_max, evi2004_8_max, evi2004_9_max, 
                           evi2004_10_max, evi2004_11, evi2004_12_max)
```

## Export EVI Max data 2004
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2004/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2004_max_stack) <- filename

# write raster stack
evi2004_max_unstack <- unstack(evi2004_max_stack)
names(evi2004_max_unstack) <- names(evi2004_max_stack)
for(i in seq_along(evi2004_max_unstack)){writeRaster(evi2004_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2005
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2005")

# list files based on prefix
evi2005_list = list.files(getwd(), pattern="2005_") 

# Create raster stack
evi2005_r <- stack(evi2005_list)
names(evi2005_r) 
```


## Calculate max evi by month per year
### 2005
```{r}
#subset by month for 2005
evi2005_1 <- raster::subset(evi2005_r, 1:2)
evi2005_2 <- raster::subset(evi2005_r, 3:4)
evi2005_3 <- raster::subset(evi2005_r, 5:6)
evi2005_4 <- raster::subset(evi2005_r, 7:8)
evi2005_5 <- raster::subset(evi2005_r, 9:10)
evi2005_6 <- raster::subset(evi2005_r, 11:12)
evi2005_7 <- raster::subset(evi2005_r, 13:14)
evi2005_8 <- raster::subset(evi2005_r, 15:16)
evi2005_9 <- raster::subset(evi2005_r, 17:18)
evi2005_10 <- raster::subset(evi2005_r, 19:19)
evi2005_11 <- raster::subset(evi2005_r, 20:21)
evi2005_12 <- raster::subset(evi2005_r, 22:23)

# calculate max evi by month for 2005
evi2005_1_max <- calc(evi2005_1, fun = max, na.rm = T)
evi2005_2_max <- calc(evi2005_2, fun = max, na.rm = T)
evi2005_3_max <- calc(evi2005_3, fun = max, na.rm = T)
evi2005_4_max <- calc(evi2005_4, fun = max, na.rm = T)
evi2005_5_max <- calc(evi2005_5, fun = max, na.rm = T)
evi2005_6_max <- calc(evi2005_6, fun = max, na.rm = T)
evi2005_7_max <- calc(evi2005_7, fun = max, na.rm = T)
evi2005_8_max <- calc(evi2005_8, fun = max, na.rm = T)
evi2005_9_max <- calc(evi2005_9, fun = max, na.rm = T)
evi2005_11_max <- calc(evi2005_11, fun = max, na.rm = T)
evi2005_12_max <- calc(evi2005_12, fun = max, na.rm = T)

# raster stack
evi2005_max_stack <- stack(evi2005_1_max, evi2005_2_max, evi2005_3_max, 
                           evi2005_4_max, evi2005_5_max, evi2005_6_max, 
                           evi2005_7_max, evi2005_8_max, evi2005_9_max, 
                           evi2005_10, evi2005_11_max, evi2005_12_max)
```

## Export EVI Max data 2005
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2005/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2005_max_stack) <- filename

# write raster stack
evi2005_max_unstack <- unstack(evi2005_max_stack)
names(evi2005_max_unstack) <- names(evi2005_max_stack)
for(i in seq_along(evi2005_max_unstack)){writeRaster(evi2005_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2006
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2006")

# list files based on prefix
evi2006_list = list.files(getwd(), pattern="2006_") 

# Create raster stack
evi2006_r <- stack(evi2006_list)
names(evi2006_r) 
```


## Calculate max evi by month per year
### 2006
```{r}
#subset by month for 2006
evi2006_1 <- raster::subset(evi2006_r, 1:2)
evi2006_2 <- raster::subset(evi2006_r, 3:4)
evi2006_3 <- raster::subset(evi2006_r, 5:6)
evi2006_4 <- raster::subset(evi2006_r, 7:8)
evi2006_5 <- raster::subset(evi2006_r, 9:10)
evi2006_6 <- raster::subset(evi2006_r, 11:12)
evi2006_7 <- raster::subset(evi2006_r, 13:14)
evi2006_8 <- raster::subset(evi2006_r, 15:16)
evi2006_9 <- raster::subset(evi2006_r, 17:18)
evi2006_10 <- raster::subset(evi2006_r, 19:19)
evi2006_11 <- raster::subset(evi2006_r, 20:21)
evi2006_12 <- raster::subset(evi2006_r, 22:23)

# calculate max evi by month for 2006
evi2006_1_max <- calc(evi2006_1, fun = max, na.rm = T)
evi2006_2_max <- calc(evi2006_2, fun = max, na.rm = T)
evi2006_3_max <- calc(evi2006_3, fun = max, na.rm = T)
evi2006_4_max <- calc(evi2006_4, fun = max, na.rm = T)
evi2006_5_max <- calc(evi2006_5, fun = max, na.rm = T)
evi2006_6_max <- calc(evi2006_6, fun = max, na.rm = T)
evi2006_7_max <- calc(evi2006_7, fun = max, na.rm = T)
evi2006_8_max <- calc(evi2006_8, fun = max, na.rm = T)
evi2006_9_max <- calc(evi2006_9, fun = max, na.rm = T)
evi2006_11_max <- calc(evi2006_11, fun = max, na.rm = T)
evi2006_12_max <- calc(evi2006_12, fun = max, na.rm = T)

# raster stack
evi2006_max_stack <- stack(evi2006_1_max, evi2006_2_max, evi2006_3_max, 
                           evi2006_4_max, evi2006_5_max, evi2006_6_max, 
                           evi2006_7_max, evi2006_8_max, evi2006_9_max, 
                           evi2006_10, evi2006_11_max, evi2006_12_max)
```

## Export EVI Max data 2006
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2006/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2006_max_stack) <- filename

# write raster stack
evi2006_max_unstack <- unstack(evi2006_max_stack)
names(evi2006_max_unstack) <- names(evi2006_max_stack)
for(i in seq_along(evi2006_max_unstack)){writeRaster(evi2006_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2007
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2007")

# list files based on prefix
evi2007_list = list.files(getwd(), pattern="2007_") 

# Create raster stack
evi2007_r <- stack(evi2007_list)
names(evi2007_r) 
```


## Calculate max evi by month per year
### 2007
```{r}
#subset by month for 2007
evi2007_1 <- raster::subset(evi2007_r, 1:2)
evi2007_2 <- raster::subset(evi2007_r, 3:4)
evi2007_3 <- raster::subset(evi2007_r, 5:6)
evi2007_4 <- raster::subset(evi2007_r, 7:8)
evi2007_5 <- raster::subset(evi2007_r, 9:10)
evi2007_6 <- raster::subset(evi2007_r, 11:12)
evi2007_7 <- raster::subset(evi2007_r, 13:14)
evi2007_8 <- raster::subset(evi2007_r, 15:16)
evi2007_9 <- raster::subset(evi2007_r, 17:18)
evi2007_10 <- raster::subset(evi2007_r, 19:19)
evi2007_11 <- raster::subset(evi2007_r, 20:21)
evi2007_12 <- raster::subset(evi2007_r, 22:23)

# calculate max evi by month for 2007
evi2007_1_max <- calc(evi2007_1, fun = max, na.rm = T)
evi2007_2_max <- calc(evi2007_2, fun = max, na.rm = T)
evi2007_3_max <- calc(evi2007_3, fun = max, na.rm = T)
evi2007_4_max <- calc(evi2007_4, fun = max, na.rm = T)
evi2007_5_max <- calc(evi2007_5, fun = max, na.rm = T)
evi2007_6_max <- calc(evi2007_6, fun = max, na.rm = T)
evi2007_7_max <- calc(evi2007_7, fun = max, na.rm = T)
evi2007_8_max <- calc(evi2007_8, fun = max, na.rm = T)
evi2007_9_max <- calc(evi2007_9, fun = max, na.rm = T)
evi2007_11_max <- calc(evi2007_11, fun = max, na.rm = T)
evi2007_12_max <- calc(evi2007_12, fun = max, na.rm = T)

# raster stack
evi2007_max_stack <- stack(evi2007_1_max, evi2007_2_max, evi2007_3_max, 
                           evi2007_4_max, evi2007_5_max, evi2007_6_max, 
                           evi2007_7_max, evi2007_8_max, evi2007_9_max, 
                           evi2007_10, evi2007_11_max, evi2007_12_max)
```

## Export EVI Max data 2007
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2007/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2007_max_stack) <- filename

# write raster stack
evi2007_max_unstack <- unstack(evi2007_max_stack)
names(evi2007_max_unstack) <- names(evi2007_max_stack)
for(i in seq_along(evi2007_max_unstack)){writeRaster(evi2007_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2008
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2008")

# list files based on prefix
evi2008_list = list.files(getwd(), pattern="2008_") 

# Create raster stack
evi2008_r <- stack(evi2008_list)
names(evi2008_r) 
```


## Calculate max evi by month per year
### 2008
```{r}
#subset by month for 2008
evi2008_1 <- raster::subset(evi2008_r, 1:2)
evi2008_2 <- raster::subset(evi2008_r, 3:4)
evi2008_3 <- raster::subset(evi2008_r, 5:6)
evi2008_4 <- raster::subset(evi2008_r, 7:8)
evi2008_5 <- raster::subset(evi2008_r, 9:10)
evi2008_6 <- raster::subset(evi2008_r, 11:12)
evi2008_7 <- raster::subset(evi2008_r, 13:14)
evi2008_8 <- raster::subset(evi2008_r, 15:16)
evi2008_9 <- raster::subset(evi2008_r, 17:18)
evi2008_10 <- raster::subset(evi2008_r, 19:20)
evi2008_11 <- raster::subset(evi2008_r, 21:21)
evi2008_12 <- raster::subset(evi2008_r, 22:23)

# calculate max evi by month for 2008
evi2008_1_max <- calc(evi2008_1, fun = max, na.rm = T)
evi2008_2_max <- calc(evi2008_2, fun = max, na.rm = T)
evi2008_3_max <- calc(evi2008_3, fun = max, na.rm = T)
evi2008_4_max <- calc(evi2008_4, fun = max, na.rm = T)
evi2008_5_max <- calc(evi2008_5, fun = max, na.rm = T)
evi2008_6_max <- calc(evi2008_6, fun = max, na.rm = T)
evi2008_7_max <- calc(evi2008_7, fun = max, na.rm = T)
evi2008_8_max <- calc(evi2008_8, fun = max, na.rm = T)
evi2008_9_max <- calc(evi2008_9, fun = max, na.rm = T)
evi2008_10_max <- calc(evi2008_10, fun = max, na.rm = T)
evi2008_12_max <- calc(evi2008_12, fun = max, na.rm = T)

# raster stack
evi2008_max_stack <- stack(evi2008_1_max, evi2008_2_max, evi2008_3_max, 
                           evi2008_4_max, evi2008_5_max, evi2008_6_max, 
                           evi2008_7_max, evi2008_8_max, evi2008_9_max, 
                           evi2008_10_max, evi2008_11, evi2008_12_max)
```

## Export EVI Max data 2008
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2008/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2008_max_stack) <- filename

# write raster stack
evi2008_max_unstack <- unstack(evi2008_max_stack)
names(evi2008_max_unstack) <- names(evi2008_max_stack)
for(i in seq_along(evi2008_max_unstack)){writeRaster(evi2008_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2009
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2009")

# list files based on prefix
evi2009_list = list.files(getwd(), pattern="2009_") 

# Create raster stack
evi2009_r <- stack(evi2009_list)
names(evi2009_r) 
```


## Calculate max evi by month per year
### 2009
```{r}
#subset by month for 2009
evi2009_1 <- raster::subset(evi2009_r, 1:2)
evi2009_2 <- raster::subset(evi2009_r, 3:4)
evi2009_3 <- raster::subset(evi2009_r, 5:6)
evi2009_4 <- raster::subset(evi2009_r, 7:8)
evi2009_5 <- raster::subset(evi2009_r, 9:10)
evi2009_6 <- raster::subset(evi2009_r, 11:12)
evi2009_7 <- raster::subset(evi2009_r, 13:14)
evi2009_8 <- raster::subset(evi2009_r, 15:16)
evi2009_9 <- raster::subset(evi2009_r, 17:18)
evi2009_10 <- raster::subset(evi2009_r, 19:19)
evi2009_11 <- raster::subset(evi2009_r, 20:21)
evi2009_12 <- raster::subset(evi2009_r, 22:23)

# calculate max evi by month for 2009
evi2009_1_max <- calc(evi2009_1, fun = max, na.rm = T)
evi2009_2_max <- calc(evi2009_2, fun = max, na.rm = T)
evi2009_3_max <- calc(evi2009_3, fun = max, na.rm = T)
evi2009_4_max <- calc(evi2009_4, fun = max, na.rm = T)
evi2009_5_max <- calc(evi2009_5, fun = max, na.rm = T)
evi2009_6_max <- calc(evi2009_6, fun = max, na.rm = T)
evi2009_7_max <- calc(evi2009_7, fun = max, na.rm = T)
evi2009_8_max <- calc(evi2009_8, fun = max, na.rm = T)
evi2009_9_max <- calc(evi2009_9, fun = max, na.rm = T)
evi2009_11_max <- calc(evi2009_11, fun = max, na.rm = T)
evi2009_12_max <- calc(evi2009_12, fun = max, na.rm = T)

# raster stack
evi2009_max_stack <- stack(evi2009_1_max, evi2009_2_max, evi2009_3_max, 
                           evi2009_4_max, evi2009_5_max, evi2009_6_max, 
                           evi2009_7_max, evi2009_8_max, evi2009_9_max, 
                           evi2009_10, evi2009_11_max, evi2009_12_max)
```

## Export EVI Max data 2009
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2009/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2009_max_stack) <- filename

# write raster stack
evi2009_max_unstack <- unstack(evi2009_max_stack)
names(evi2009_max_unstack) <- names(evi2009_max_stack)
for(i in seq_along(evi2009_max_unstack)){writeRaster(evi2009_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2010
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2010")

# list files based on prefix
evi2010_list = list.files(getwd(), pattern="2010_") 

# Create raster stack
evi2010_r <- stack(evi2010_list)
names(evi2010_r) 
```


## Calculate max evi by month per year
### 2010
```{r}
#subset by month for 2010
evi2010_1 <- raster::subset(evi2010_r, 1:2)
evi2010_2 <- raster::subset(evi2010_r, 3:4)
evi2010_3 <- raster::subset(evi2010_r, 5:6)
evi2010_4 <- raster::subset(evi2010_r, 7:8)
evi2010_5 <- raster::subset(evi2010_r, 9:10)
evi2010_6 <- raster::subset(evi2010_r, 11:12)
evi2010_7 <- raster::subset(evi2010_r, 13:14)
evi2010_8 <- raster::subset(evi2010_r, 15:16)
evi2010_9 <- raster::subset(evi2010_r, 17:18)
evi2010_10 <- raster::subset(evi2010_r, 19:19)
evi2010_11 <- raster::subset(evi2010_r, 20:21)
evi2010_12 <- raster::subset(evi2010_r, 22:23)

# calculate max evi by month for 2010
evi2010_1_max <- calc(evi2010_1, fun = max, na.rm = T)
evi2010_2_max <- calc(evi2010_2, fun = max, na.rm = T)
evi2010_3_max <- calc(evi2010_3, fun = max, na.rm = T)
evi2010_4_max <- calc(evi2010_4, fun = max, na.rm = T)
evi2010_5_max <- calc(evi2010_5, fun = max, na.rm = T)
evi2010_6_max <- calc(evi2010_6, fun = max, na.rm = T)
evi2010_7_max <- calc(evi2010_7, fun = max, na.rm = T)
evi2010_8_max <- calc(evi2010_8, fun = max, na.rm = T)
evi2010_9_max <- calc(evi2010_9, fun = max, na.rm = T)
evi2010_11_max <- calc(evi2010_11, fun = max, na.rm = T)
evi2010_12_max <- calc(evi2010_12, fun = max, na.rm = T)

# raster stack
evi2010_max_stack <- stack(evi2010_1_max, evi2010_2_max, evi2010_3_max, 
                           evi2010_4_max, evi2010_5_max, evi2010_6_max, 
                           evi2010_7_max, evi2010_8_max, evi2010_9_max, 
                           evi2010_10, evi2010_11_max, evi2010_12_max)
```

## Export EVI Max data 2010
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2010/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2010_max_stack) <- filename

# write raster stack
evi2010_max_unstack <- unstack(evi2010_max_stack)
names(evi2010_max_unstack) <- names(evi2010_max_stack)
for(i in seq_along(evi2010_max_unstack)){writeRaster(evi2010_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2011
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2011")

# list files based on prefix
evi2011_list = list.files(getwd(), pattern="2011_") 

# Create raster stack
evi2011_r <- stack(evi2011_list)
names(evi2011_r) 
```


## Calculate max evi by month per year
### 2011
```{r}
#subset by month for 2011
evi2011_1 <- raster::subset(evi2011_r, 1:2)
evi2011_2 <- raster::subset(evi2011_r, 3:4)
evi2011_3 <- raster::subset(evi2011_r, 5:6)
evi2011_4 <- raster::subset(evi2011_r, 7:8)
evi2011_5 <- raster::subset(evi2011_r, 9:10)
evi2011_6 <- raster::subset(evi2011_r, 11:12)
evi2011_7 <- raster::subset(evi2011_r, 13:14)
evi2011_8 <- raster::subset(evi2011_r, 15:16)
evi2011_9 <- raster::subset(evi2011_r, 17:18)
evi2011_10 <- raster::subset(evi2011_r, 19:19)
evi2011_11 <- raster::subset(evi2011_r, 20:21)
evi2011_12 <- raster::subset(evi2011_r, 22:23)

# calculate max evi by month for 2011
evi2011_1_max <- calc(evi2011_1, fun = max, na.rm = T)
evi2011_2_max <- calc(evi2011_2, fun = max, na.rm = T)
evi2011_3_max <- calc(evi2011_3, fun = max, na.rm = T)
evi2011_4_max <- calc(evi2011_4, fun = max, na.rm = T)
evi2011_5_max <- calc(evi2011_5, fun = max, na.rm = T)
evi2011_6_max <- calc(evi2011_6, fun = max, na.rm = T)
evi2011_7_max <- calc(evi2011_7, fun = max, na.rm = T)
evi2011_8_max <- calc(evi2011_8, fun = max, na.rm = T)
evi2011_9_max <- calc(evi2011_9, fun = max, na.rm = T)
evi2011_11_max <- calc(evi2011_11, fun = max, na.rm = T)
evi2011_12_max <- calc(evi2011_12, fun = max, na.rm = T)

# raster stack
evi2011_max_stack <- stack(evi2011_1_max, evi2011_2_max, evi2011_3_max, 
                           evi2011_4_max, evi2011_5_max, evi2011_6_max, 
                           evi2011_7_max, evi2011_8_max, evi2011_9_max, 
                           evi2011_10, evi2011_11_max, evi2011_12_max)
```

## Export EVI Max data 2011
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2011/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2011_max_stack) <- filename

# write raster stack
evi2011_max_unstack <- unstack(evi2011_max_stack)
names(evi2011_max_unstack) <- names(evi2011_max_stack)
for(i in seq_along(evi2011_max_unstack)){writeRaster(evi2011_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2012
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2012")

# list files based on prefix
evi2012_list = list.files(getwd(), pattern="2012_") 

# Create raster stack
evi2012_r <- stack(evi2012_list)
names(evi2012_r) 
```


## Calculate max evi by month per year
### 2012
```{r}
#subset by month for 2012
evi2012_1 <- raster::subset(evi2012_r, 1:2)
evi2012_2 <- raster::subset(evi2012_r, 3:4)
evi2012_3 <- raster::subset(evi2012_r, 5:6)
evi2012_4 <- raster::subset(evi2012_r, 7:8)
evi2012_5 <- raster::subset(evi2012_r, 9:10)
evi2012_6 <- raster::subset(evi2012_r, 11:12)
evi2012_7 <- raster::subset(evi2012_r, 13:14)
evi2012_8 <- raster::subset(evi2012_r, 15:16)
evi2012_9 <- raster::subset(evi2012_r, 17:18)
evi2012_10 <- raster::subset(evi2012_r, 19:20)
evi2012_11 <- raster::subset(evi2012_r, 21:21)
evi2012_12 <- raster::subset(evi2012_r, 22:23)

# calculate max evi by month for 2012
evi2012_1_max <- calc(evi2012_1, fun = max, na.rm = T)
evi2012_2_max <- calc(evi2012_2, fun = max, na.rm = T)
evi2012_3_max <- calc(evi2012_3, fun = max, na.rm = T)
evi2012_4_max <- calc(evi2012_4, fun = max, na.rm = T)
evi2012_5_max <- calc(evi2012_5, fun = max, na.rm = T)
evi2012_6_max <- calc(evi2012_6, fun = max, na.rm = T)
evi2012_7_max <- calc(evi2012_7, fun = max, na.rm = T)
evi2012_8_max <- calc(evi2012_8, fun = max, na.rm = T)
evi2012_9_max <- calc(evi2012_9, fun = max, na.rm = T)
evi2012_10_max <- calc(evi2012_10, fun = max, na.rm = T)
evi2012_12_max <- calc(evi2012_12, fun = max, na.rm = T)

# raster stack
evi2012_max_stack <- stack(evi2012_1_max, evi2012_2_max, evi2012_3_max, 
                           evi2012_4_max, evi2012_5_max, evi2012_6_max, 
                           evi2012_7_max, evi2012_8_max, evi2012_9_max, 
                           evi2012_10_max, evi2012_11, evi2012_12_max)
```

## Export EVI Max data 2012
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2012/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2012_max_stack) <- filename

# write raster stack
evi2012_max_unstack <- unstack(evi2012_max_stack)
names(evi2012_max_unstack) <- names(evi2012_max_stack)
for(i in seq_along(evi2012_max_unstack)){writeRaster(evi2012_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2013
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2013")

# list files based on prefix
evi2013_list = list.files(getwd(), pattern="2013_") 

# Create raster stack
evi2013_r <- stack(evi2013_list)
names(evi2013_r) 
```


## Calculate max evi by month per year
### 2013
```{r}
#subset by month for 2013
evi2013_1 <- raster::subset(evi2013_r, 1:2)
evi2013_2 <- raster::subset(evi2013_r, 3:4)
evi2013_3 <- raster::subset(evi2013_r, 5:6)
evi2013_4 <- raster::subset(evi2013_r, 7:8)
evi2013_5 <- raster::subset(evi2013_r, 9:10)
evi2013_6 <- raster::subset(evi2013_r, 11:12)
evi2013_7 <- raster::subset(evi2013_r, 13:14)
evi2013_8 <- raster::subset(evi2013_r, 15:16)
evi2013_9 <- raster::subset(evi2013_r, 17:18)
evi2013_10 <- raster::subset(evi2013_r, 19:19)
evi2013_11 <- raster::subset(evi2013_r, 20:21)
evi2013_12 <- raster::subset(evi2013_r, 22:23)

# calculate max evi by month for 2013
evi2013_1_max <- calc(evi2013_1, fun = max, na.rm = T)
evi2013_2_max <- calc(evi2013_2, fun = max, na.rm = T)
evi2013_3_max <- calc(evi2013_3, fun = max, na.rm = T)
evi2013_4_max <- calc(evi2013_4, fun = max, na.rm = T)
evi2013_5_max <- calc(evi2013_5, fun = max, na.rm = T)
evi2013_6_max <- calc(evi2013_6, fun = max, na.rm = T)
evi2013_7_max <- calc(evi2013_7, fun = max, na.rm = T)
evi2013_8_max <- calc(evi2013_8, fun = max, na.rm = T)
evi2013_9_max <- calc(evi2013_9, fun = max, na.rm = T)
evi2013_11_max <- calc(evi2013_11, fun = max, na.rm = T)
evi2013_12_max <- calc(evi2013_12, fun = max, na.rm = T)

# raster stack
evi2013_max_stack <- stack(evi2013_1_max, evi2013_2_max, evi2013_3_max, 
                           evi2013_4_max, evi2013_5_max, evi2013_6_max, 
                           evi2013_7_max, evi2013_8_max, evi2013_9_max, 
                           evi2013_10, evi2013_11_max, evi2013_12_max)
```

## Export EVI Max data 2013
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2013/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2013_max_stack) <- filename

# write raster stack
evi2013_max_unstack <- unstack(evi2013_max_stack)
names(evi2013_max_unstack) <- names(evi2013_max_stack)
for(i in seq_along(evi2013_max_unstack)){writeRaster(evi2013_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2014
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2014")

# list files based on prefix
evi2014_list = list.files(getwd(), pattern="2014_") 

# Create raster stack
evi2014_r <- stack(evi2014_list)
names(evi2014_r) 
```


## Calculate max evi by month per year
### 2014
```{r}
#subset by month for 2014
evi2014_1 <- raster::subset(evi2014_r, 1:2)
evi2014_2 <- raster::subset(evi2014_r, 3:4)
evi2014_3 <- raster::subset(evi2014_r, 5:6)
evi2014_4 <- raster::subset(evi2014_r, 7:8)
evi2014_5 <- raster::subset(evi2014_r, 9:10)
evi2014_6 <- raster::subset(evi2014_r, 11:12)
evi2014_7 <- raster::subset(evi2014_r, 13:14)
evi2014_8 <- raster::subset(evi2014_r, 15:16)
evi2014_9 <- raster::subset(evi2014_r, 17:18)
evi2014_10 <- raster::subset(evi2014_r, 19:19)
evi2014_11 <- raster::subset(evi2014_r, 20:21)
evi2014_12 <- raster::subset(evi2014_r, 22:23)

# calculate max evi by month for 2014
evi2014_1_max <- calc(evi2014_1, fun = max, na.rm = T)
evi2014_2_max <- calc(evi2014_2, fun = max, na.rm = T)
evi2014_3_max <- calc(evi2014_3, fun = max, na.rm = T)
evi2014_4_max <- calc(evi2014_4, fun = max, na.rm = T)
evi2014_5_max <- calc(evi2014_5, fun = max, na.rm = T)
evi2014_6_max <- calc(evi2014_6, fun = max, na.rm = T)
evi2014_7_max <- calc(evi2014_7, fun = max, na.rm = T)
evi2014_8_max <- calc(evi2014_8, fun = max, na.rm = T)
evi2014_9_max <- calc(evi2014_9, fun = max, na.rm = T)
evi2014_11_max <- calc(evi2014_11, fun = max, na.rm = T)
evi2014_12_max <- calc(evi2014_12, fun = max, na.rm = T)

# raster stack
evi2014_max_stack <- stack(evi2014_1_max, evi2014_2_max, evi2014_3_max, 
                           evi2014_4_max, evi2014_5_max, evi2014_6_max, 
                           evi2014_7_max, evi2014_8_max, evi2014_9_max, 
                           evi2014_10, evi2014_11_max, evi2014_12_max)
```

## Export EVI Max data 2014
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2014/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2014_max_stack) <- filename

# write raster stack
evi2014_max_unstack <- unstack(evi2014_max_stack)
names(evi2014_max_unstack) <- names(evi2014_max_stack)
for(i in seq_along(evi2014_max_unstack)){writeRaster(evi2014_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2015
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2015")

# list files based on prefix
evi2015_list = list.files(getwd(), pattern="2015_") 

# Create raster stack
evi2015_r <- stack(evi2015_list)
names(evi2015_r) 
```


## Calculate max evi by month per year
### 2015
```{r}
#subset by month for 2015
evi2015_1 <- raster::subset(evi2015_r, 1:2)
evi2015_2 <- raster::subset(evi2015_r, 3:4)
evi2015_3 <- raster::subset(evi2015_r, 5:6)
evi2015_4 <- raster::subset(evi2015_r, 7:8)
evi2015_5 <- raster::subset(evi2015_r, 9:10)
evi2015_6 <- raster::subset(evi2015_r, 11:12)
evi2015_7 <- raster::subset(evi2015_r, 13:14)
evi2015_8 <- raster::subset(evi2015_r, 15:16)
evi2015_9 <- raster::subset(evi2015_r, 17:18)
evi2015_10 <- raster::subset(evi2015_r, 19:19)
evi2015_11 <- raster::subset(evi2015_r, 20:21)
evi2015_12 <- raster::subset(evi2015_r, 22:23)

# calculate max evi by month for 2015
evi2015_1_max <- calc(evi2015_1, fun = max, na.rm = T)
evi2015_2_max <- calc(evi2015_2, fun = max, na.rm = T)
evi2015_3_max <- calc(evi2015_3, fun = max, na.rm = T)
evi2015_4_max <- calc(evi2015_4, fun = max, na.rm = T)
evi2015_5_max <- calc(evi2015_5, fun = max, na.rm = T)
evi2015_6_max <- calc(evi2015_6, fun = max, na.rm = T)
evi2015_7_max <- calc(evi2015_7, fun = max, na.rm = T)
evi2015_8_max <- calc(evi2015_8, fun = max, na.rm = T)
evi2015_9_max <- calc(evi2015_9, fun = max, na.rm = T)
evi2015_11_max <- calc(evi2015_11, fun = max, na.rm = T)
evi2015_12_max <- calc(evi2015_12, fun = max, na.rm = T)

# raster stack
evi2015_max_stack <- stack(evi2015_1_max, evi2015_2_max, evi2015_3_max, 
                           evi2015_4_max, evi2015_5_max, evi2015_6_max, 
                           evi2015_7_max, evi2015_8_max, evi2015_9_max, 
                           evi2015_10, evi2015_11_max, evi2015_12_max)
```

## Export EVI Max data 2015
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2015/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2015_max_stack) <- filename

# write raster stack
evi2015_max_unstack <- unstack(evi2015_max_stack)
names(evi2015_max_unstack) <- names(evi2015_max_stack)
for(i in seq_along(evi2015_max_unstack)){writeRaster(evi2015_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2016
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2016")

# list files based on prefix
evi2016_list = list.files(getwd(), pattern="2016_") 

# Create raster stack
evi2016_r <- stack(evi2016_list)
names(evi2016_r) 
```


## Calculate max evi by month per year
### 2016
```{r}
#subset by month for 2016
evi2016_1 <- raster::subset(evi2016_r, 1:2)
evi2016_2 <- raster::subset(evi2016_r, 3:4)
evi2016_3 <- raster::subset(evi2016_r, 5:6)
evi2016_4 <- raster::subset(evi2016_r, 7:8)
evi2016_5 <- raster::subset(evi2016_r, 9:10)
evi2016_6 <- raster::subset(evi2016_r, 11:12)
evi2016_7 <- raster::subset(evi2016_r, 13:14)
evi2016_8 <- raster::subset(evi2016_r, 15:16)
evi2016_9 <- raster::subset(evi2016_r, 17:18)
evi2016_10 <- raster::subset(evi2016_r, 19:20)
evi2016_11 <- raster::subset(evi2016_r, 21:21)
evi2016_12 <- raster::subset(evi2016_r, 22:23)

# calculate max evi by month for 2016
evi2016_1_max <- calc(evi2016_1, fun = max, na.rm = T)
evi2016_2_max <- calc(evi2016_2, fun = max, na.rm = T)
evi2016_3_max <- calc(evi2016_3, fun = max, na.rm = T)
evi2016_4_max <- calc(evi2016_4, fun = max, na.rm = T)
evi2016_5_max <- calc(evi2016_5, fun = max, na.rm = T)
evi2016_6_max <- calc(evi2016_6, fun = max, na.rm = T)
evi2016_7_max <- calc(evi2016_7, fun = max, na.rm = T)
evi2016_8_max <- calc(evi2016_8, fun = max, na.rm = T)
evi2016_9_max <- calc(evi2016_9, fun = max, na.rm = T)
evi2016_10_max <- calc(evi2016_10, fun = max, na.rm = T)
evi2016_12_max <- calc(evi2016_12, fun = max, na.rm = T)

# raster stack
evi2016_max_stack <- stack(evi2016_1_max, evi2016_2_max, evi2016_3_max, 
                           evi2016_4_max, evi2016_5_max, evi2016_6_max, 
                           evi2016_7_max, evi2016_8_max, evi2016_9_max, 
                           evi2016_10_max, evi2016_11, evi2016_12_max)
```

## Export EVI Max data 2016
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2016/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2016_max_stack) <- filename

# write raster stack
evi2016_max_unstack <- unstack(evi2016_max_stack)
names(evi2016_max_unstack) <- names(evi2016_max_stack)
for(i in seq_along(evi2016_max_unstack)){writeRaster(evi2016_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2017
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2017")

# list files based on prefix
evi2017_list = list.files(getwd(), pattern="2017_") 

# Create raster stack
evi2017_r <- stack(evi2017_list)
names(evi2017_r) 
```


## Calculate max evi by month per year
### 2017
```{r}
#subset by month for 2017
evi2017_1 <- raster::subset(evi2017_r, 1:2)
evi2017_2 <- raster::subset(evi2017_r, 3:4)
evi2017_3 <- raster::subset(evi2017_r, 5:6)
evi2017_4 <- raster::subset(evi2017_r, 7:8)
evi2017_5 <- raster::subset(evi2017_r, 9:10)
evi2017_6 <- raster::subset(evi2017_r, 11:12)
evi2017_7 <- raster::subset(evi2017_r, 13:14)
evi2017_8 <- raster::subset(evi2017_r, 15:16)
evi2017_9 <- raster::subset(evi2017_r, 17:18)
evi2017_10 <- raster::subset(evi2017_r, 19:19)
evi2017_11 <- raster::subset(evi2017_r, 20:21)
evi2017_12 <- raster::subset(evi2017_r, 22:23)

# calculate max evi by month for 2017
evi2017_1_max <- calc(evi2017_1, fun = max, na.rm = T)
evi2017_2_max <- calc(evi2017_2, fun = max, na.rm = T)
evi2017_3_max <- calc(evi2017_3, fun = max, na.rm = T)
evi2017_4_max <- calc(evi2017_4, fun = max, na.rm = T)
evi2017_5_max <- calc(evi2017_5, fun = max, na.rm = T)
evi2017_6_max <- calc(evi2017_6, fun = max, na.rm = T)
evi2017_7_max <- calc(evi2017_7, fun = max, na.rm = T)
evi2017_8_max <- calc(evi2017_8, fun = max, na.rm = T)
evi2017_9_max <- calc(evi2017_9, fun = max, na.rm = T)
evi2017_11_max <- calc(evi2017_11, fun = max, na.rm = T)
evi2017_12_max <- calc(evi2017_12, fun = max, na.rm = T)

# raster stack
evi2017_max_stack <- stack(evi2017_1_max, evi2017_2_max, evi2017_3_max, 
                           evi2017_4_max, evi2017_5_max, evi2017_6_max, 
                           evi2017_7_max, evi2017_8_max, evi2017_9_max, 
                           evi2017_10, evi2017_11_max, evi2017_12_max)
```

## Export EVI Max data 2017
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2017/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2017_max_stack) <- filename

# write raster stack
evi2017_max_unstack <- unstack(evi2017_max_stack)
names(evi2017_max_unstack) <- names(evi2017_max_stack)
for(i in seq_along(evi2017_max_unstack)){writeRaster(evi2017_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2018
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2018")

# list files based on prefix
evi2018_list = list.files(getwd(), pattern="2018_") 

# Create raster stack
evi2018_r <- stack(evi2018_list)
names(evi2018_r) 
```


## Calculate max evi by month per year
### 2018
```{r}
#subset by month for 2018
evi2018_1 <- raster::subset(evi2018_r, 1:2)
evi2018_2 <- raster::subset(evi2018_r, 3:4)
evi2018_3 <- raster::subset(evi2018_r, 5:6)
evi2018_4 <- raster::subset(evi2018_r, 7:8)
evi2018_5 <- raster::subset(evi2018_r, 9:10)
evi2018_6 <- raster::subset(evi2018_r, 11:12)
evi2018_7 <- raster::subset(evi2018_r, 13:14)
evi2018_8 <- raster::subset(evi2018_r, 15:16)
evi2018_9 <- raster::subset(evi2018_r, 17:18)
evi2018_10 <- raster::subset(evi2018_r, 19:19)
evi2018_11 <- raster::subset(evi2018_r, 20:21)
evi2018_12 <- raster::subset(evi2018_r, 22:23)

# calculate max evi by month for 2018
evi2018_1_max <- calc(evi2018_1, fun = max, na.rm = T)
evi2018_2_max <- calc(evi2018_2, fun = max, na.rm = T)
evi2018_3_max <- calc(evi2018_3, fun = max, na.rm = T)
evi2018_4_max <- calc(evi2018_4, fun = max, na.rm = T)
evi2018_5_max <- calc(evi2018_5, fun = max, na.rm = T)
evi2018_6_max <- calc(evi2018_6, fun = max, na.rm = T)
evi2018_7_max <- calc(evi2018_7, fun = max, na.rm = T)
evi2018_8_max <- calc(evi2018_8, fun = max, na.rm = T)
evi2018_9_max <- calc(evi2018_9, fun = max, na.rm = T)
evi2018_11_max <- calc(evi2018_11, fun = max, na.rm = T)
evi2018_12_max <- calc(evi2018_12, fun = max, na.rm = T)

# raster stack
evi2018_max_stack <- stack(evi2018_1_max, evi2018_2_max, evi2018_3_max, 
                           evi2018_4_max, evi2018_5_max, evi2018_6_max, 
                           evi2018_7_max, evi2018_8_max, evi2018_9_max, 
                           evi2018_10, evi2018_11_max, evi2018_12_max)
```

## Export EVI Max data 2018
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2018/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2018_max_stack) <- filename

# write raster stack
evi2018_max_unstack <- unstack(evi2018_max_stack)
names(evi2018_max_unstack) <- names(evi2018_max_stack)
for(i in seq_along(evi2018_max_unstack)){writeRaster(evi2018_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2019
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2019")

# list files based on prefix
evi2019_list = list.files(getwd(), pattern="2019_") 

# Create raster stack
evi2019_r <- stack(evi2019_list)
names(evi2019_r) 
```


## Calculate max evi by month per year
### 2019
```{r}
#subset by month for 2019
evi2019_1 <- raster::subset(evi2019_r, 1:2)
evi2019_2 <- raster::subset(evi2019_r, 3:4)
evi2019_3 <- raster::subset(evi2019_r, 5:6)
evi2019_4 <- raster::subset(evi2019_r, 7:8)
evi2019_5 <- raster::subset(evi2019_r, 9:10)
evi2019_6 <- raster::subset(evi2019_r, 11:12)
evi2019_7 <- raster::subset(evi2019_r, 13:14)
evi2019_8 <- raster::subset(evi2019_r, 15:16)
evi2019_9 <- raster::subset(evi2019_r, 17:18)
evi2019_10 <- raster::subset(evi2019_r, 19:19)
evi2019_11 <- raster::subset(evi2019_r, 20:21)
evi2019_12 <- raster::subset(evi2019_r, 22:23)

# calculate max evi by month for 2019
evi2019_1_max <- calc(evi2019_1, fun = max, na.rm = T)
evi2019_2_max <- calc(evi2019_2, fun = max, na.rm = T)
evi2019_3_max <- calc(evi2019_3, fun = max, na.rm = T)
evi2019_4_max <- calc(evi2019_4, fun = max, na.rm = T)
evi2019_5_max <- calc(evi2019_5, fun = max, na.rm = T)
evi2019_6_max <- calc(evi2019_6, fun = max, na.rm = T)
evi2019_7_max <- calc(evi2019_7, fun = max, na.rm = T)
evi2019_8_max <- calc(evi2019_8, fun = max, na.rm = T)
evi2019_9_max <- calc(evi2019_9, fun = max, na.rm = T)
evi2019_11_max <- calc(evi2019_11, fun = max, na.rm = T)
evi2019_12_max <- calc(evi2019_12, fun = max, na.rm = T)

# raster stack
evi2019_max_stack <- stack(evi2019_1_max, evi2019_2_max, evi2019_3_max, 
                           evi2019_4_max, evi2019_5_max, evi2019_6_max, 
                           evi2019_7_max, evi2019_8_max, evi2019_9_max, 
                           evi2019_10, evi2019_11_max, evi2019_12_max)
```

## Export EVI Max data 2019
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2019/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2019_max_stack) <- filename

# write raster stack
evi2019_max_unstack <- unstack(evi2019_max_stack)
names(evi2019_max_unstack) <- names(evi2019_max_stack)
for(i in seq_along(evi2019_max_unstack)){writeRaster(evi2019_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```

--------------------------------------------------------------------------------
# Vegetation - 2020
## Read MODIS EVI data
```{r}
# import MODIS Veg Indices  
# set working directory to where data is located
setwd("D:/WCS/data/evi/GEE/MODIS_EVI-20210427T034248Z-001/MODIS_EVI/EVI2020")

# list files based on prefix
evi2020_list = list.files(getwd(), pattern="2020_") 

# Create raster stack
evi2020_r <- stack(evi2020_list)
names(evi2020_r) 
```


## Calculate max evi by month per year
### 2020
```{r}
#subset by month for 2020
evi2020_1 <- raster::subset(evi2020_r, 1:2)
evi2020_2 <- raster::subset(evi2020_r, 3:4)
evi2020_3 <- raster::subset(evi2020_r, 5:6)
evi2020_4 <- raster::subset(evi2020_r, 7:8)
evi2020_5 <- raster::subset(evi2020_r, 9:10)
evi2020_6 <- raster::subset(evi2020_r, 11:12)
evi2020_7 <- raster::subset(evi2020_r, 13:14)
evi2020_8 <- raster::subset(evi2020_r, 15:16)
evi2020_9 <- raster::subset(evi2020_r, 17:18)
evi2020_10 <- raster::subset(evi2020_r, 19:20)
evi2020_11 <- raster::subset(evi2020_r, 21:21)
evi2020_12 <- raster::subset(evi2020_r, 22:23)

# calculate max evi by month for 2020
evi2020_1_max <- calc(evi2020_1, fun = max, na.rm = T)
evi2020_2_max <- calc(evi2020_2, fun = max, na.rm = T)
evi2020_3_max <- calc(evi2020_3, fun = max, na.rm = T)
evi2020_4_max <- calc(evi2020_4, fun = max, na.rm = T)
evi2020_5_max <- calc(evi2020_5, fun = max, na.rm = T)
evi2020_6_max <- calc(evi2020_6, fun = max, na.rm = T)
evi2020_7_max <- calc(evi2020_7, fun = max, na.rm = T)
evi2020_8_max <- calc(evi2020_8, fun = max, na.rm = T)
evi2020_9_max <- calc(evi2020_9, fun = max, na.rm = T)
evi2020_10_max <- calc(evi2020_10, fun = max, na.rm = T)
evi2020_12_max <- calc(evi2020_12, fun = max, na.rm = T)

# raster stack
evi2020_max_stack <- stack(evi2020_1_max, evi2020_2_max, evi2020_3_max, 
                           evi2020_4_max, evi2020_5_max, evi2020_6_max, 
                           evi2020_7_max, evi2020_8_max, evi2020_9_max, 
                           evi2020_10_max, evi2020_11, evi2020_12_max)
```

## Export EVI Max data 2020
```{r}
#set wd for output
setwd("D:/WCS/data/evi/r_outputs")

# name output rasters
date <- seq(as.Date("2020/01/01"), by = "month", length.out = 12)
month <- substr(date,1, 7)

filename = paste0("evi_",month)
names(evi2020_max_stack) <- filename

# write raster stack
evi2020_max_unstack <- unstack(evi2020_max_stack)
names(evi2020_max_unstack) <- names(evi2020_max_stack)
for(i in seq_along(evi2020_max_unstack)){writeRaster(evi2020_max_unstack[[i]], file=filename[i], format="GTiff", overwrite = TRUE)}
```
